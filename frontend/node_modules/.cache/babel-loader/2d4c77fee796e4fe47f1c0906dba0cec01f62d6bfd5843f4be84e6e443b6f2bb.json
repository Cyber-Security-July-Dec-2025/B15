{"ast":null,"code":"var _jsxFileName = \"/home/rounak-dagar/securechat/frontend/src/components/Chat/ChatContainer.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { usersAPI, messagesAPI } from '../../services/api';\nimport { hybridEncryptMessage, hybridDecryptMessage, decryptPrivateKeyAES } from '../../services/crypto';\nimport { getSocket } from '../../services/socket';\nimport { PaperAirplaneIcon, LockClosedIcon, PhoneIcon, EllipsisVerticalIcon, MagnifyingGlassIcon, FaceSmileIcon, PaperClipIcon } from '@heroicons/react/24/solid';\n\n// -----------------------------------------------------------------------------\n// ChatContainer (polished UI). Core logic is intentionally preserved (APIs,\n// encryption hooks and socket usage remain the same) while styles/layout are\n// improved for a professional look and reliable behavior.\n// -----------------------------------------------------------------------------\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatContainer = ({\n  currentUser,\n  showStatus\n}) => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Cache decrypted private key for session\n  const decryptedPrivateKeyRef = useRef(null);\n  const passphraseRef = useRef('');\n\n  // Scroll management\n  const messagesEndRef = useRef(null);\n  const messageListRef = useRef(null);\n  useEffect(() => {\n    let mounted = true;\n    usersAPI.getAllUsers().then(res => {\n      if (!mounted) return;\n      // Filter out current user (if returned) and ensure required fields\n      const fetched = (res.data || []).filter(u => u.username !== currentUser.username).map(u => ({\n        username: u.username,\n        publicKey: u.publicKey,\n        isOnline: !!u.isOnline,\n        lastMessage: u.lastMessage || null\n      }));\n      setUsers(fetched);\n    }).catch(() => {\n      showStatus('Failed to fetch users', 'error');\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [currentUser.username]);\n  useEffect(() => {\n    if (!selectedUser) return;\n    messagesAPI.getConversation(selectedUser.username).then(res => setMessages(Array.isArray(res.data) ? res.data : [])).catch(() => setMessages([]));\n  }, [selectedUser]);\n\n  // Socket receive\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n    const handler = msg => {\n      // If the incoming message belongs to current selected conversation, append\n      if (msg.from === (selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username) || msg.to === (selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username)) {\n        setMessages(prev => [...prev, msg]);\n      }\n      // also update user's last online/last message preview in sidebar\n      setUsers(prev => prev.map(u => u.username === (msg.from === currentUser.username ? msg.to : msg.from) ? {\n        ...u,\n        lastMessage: msg\n      } : u));\n    };\n    socket.on('receive_message', handler);\n    return () => socket.off('receive_message', handler);\n  }, [selectedUser, currentUser.username]);\n\n  // Prompt for password and decrypt private key once per session\n  const getDecryptedPrivateKey = async () => {\n    if (decryptedPrivateKeyRef.current) return decryptedPrivateKeyRef.current;\n    const encryptedPrivateKey = localStorage.getItem('privateKey');\n    let passphrase = passphraseRef.current;\n    if (!passphrase) {\n      passphrase = window.prompt('Enter your password to decrypt your private key:');\n      passphraseRef.current = passphrase;\n    }\n    try {\n      const privateKeyArmored = await decryptPrivateKeyAES(encryptedPrivateKey, passphrase);\n      decryptedPrivateKeyRef.current = privateKeyArmored;\n      return privateKeyArmored;\n    } catch (err) {\n      showStatus('Failed to decrypt private key. Wrong password?', 'error');\n      decryptedPrivateKeyRef.current = null;\n      passphraseRef.current = '';\n      throw err;\n    }\n  };\n  const sendMessage = async e => {\n    e && e.preventDefault();\n    if (!input || !selectedUser) return;\n    setLoading(true);\n    try {\n      const {\n        encryptedMessage,\n        encryptedAESKey\n      } = await hybridEncryptMessage(input, selectedUser.publicKey);\n      const messageData = {\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      };\n      await messagesAPI.sendMessage(messageData);\n\n      // Add plaintext to local message for sender\n      const outgoing = {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text',\n        plaintext: input,\n        timestamp: Date.now()\n      };\n      setMessages(prev => [...prev, outgoing]);\n      getSocket().emit('send_message', {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      });\n\n      // Update sidebar preview\n      setUsers(prev => prev.map(u => u.username === selectedUser.username ? {\n        ...u,\n        lastMessage: outgoing\n      } : u));\n      setInput('');\n      autoGrowTextarea();\n      showStatus('Message sent', 'success');\n    } catch (err) {\n      showStatus('Failed to send message', 'error');\n    }\n    setLoading(false);\n  };\n\n  // Keep messages scrolled to bottom (most recent at bottom visually)\n  useEffect(() => {\n    if (!messageListRef.current) return;\n    // A short timeout lets DOM settle\n    const t = setTimeout(() => {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: 'smooth',\n        block: 'end'\n      });\n    }, 60);\n    return () => clearTimeout(t);\n  }, [messages, selectedUser]);\n\n  // Autosize textarea\n  const textareaRef = useRef(null);\n  const autoGrowTextarea = () => {\n    const ta = textareaRef.current;\n    if (!ta) return;\n    ta.style.height = 'auto';\n    ta.style.height = Math.min(ta.scrollHeight, 160) + 'px';\n  };\n  useEffect(() => {\n    autoGrowTextarea();\n  }, [input]);\n\n  // Small helpers\n  const getAvatar = (username, size = 10) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex-shrink-0 inline-flex items-center justify-center rounded-full select-none`,\n    style: {\n      width: `${size}rem`,\n      height: `${size}rem`,\n      background: `linear-gradient(135deg,#7c3aed,#06b6d4)`\n    },\n    children: /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"text-white font-semibold\",\n      style: {\n        fontSize: `${size / 2}rem`\n      },\n      children: username.slice(0, 2).toUpperCase()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n  const formatPreview = msg => {\n    if (!msg) return '';\n    if (typeof msg === 'string') return msg;\n    return msg.plaintext || '[Encrypted]';\n  };\n  const renderUsers = () => /*#__PURE__*/_jsxDEV(\"ul\", {\n    className: \"space-y-2 mt-4 px-2 pb-6\",\n    children: users.map(user => /*#__PURE__*/_jsxDEV(\"li\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setSelectedUser(user),\n        className: `w-full flex items-center gap-3 p-3 rounded-xl transition-colors duration-150 text-left ${(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username) === user.username ? 'bg-slate-700/60' : 'hover:bg-slate-700/30'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          children: [getAvatar(user.username, 2.5), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `absolute bottom-0 right-0 block w-3 h-3 rounded-full border-2 border-slate-900 ${user.isOnline ? 'bg-green-400' : 'bg-gray-500'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 min-w-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-semibold truncate mr-2\",\n              children: user.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-300 truncate mt-1\",\n            children: formatPreview(user.lastMessage)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 11\n      }, this)\n    }, user.username, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 181,\n    columnNumber: 5\n  }, this);\n  const renderMessages = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: messageListRef,\n    className: \"flex-1 overflow-y-auto px-6 py-4 flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(MessageItem, {\n      msg: msg,\n      currentUser: currentUser,\n      getDecryptedPrivateKey: getDecryptedPrivateKey\n    }, idx, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: messagesEndRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 206,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex h-screen font-inter bg-slate-900 text-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"flex flex-col w-88 min-w-[20rem] max-w-sm bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 border-r border-slate-800 shadow-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-6 py-5 border-b border-slate-800 flex flex-col gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-extrabold text-2xl tracking-tight text-indigo-400 drop-shadow-lg\",\n              children: \"SecureChat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(LockClosedIcon, {\n              style: {\n                width: 18,\n                height: 18\n              },\n              className: \"text-indigo-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 15\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400\",\n            children: currentUser.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative w-full\",\n          children: [/*#__PURE__*/_jsxDEV(MagnifyingGlassIcon, {\n            style: {\n              width: 18,\n              height: 18\n            },\n            className: \"absolute left-3 top-3 text-gray-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"w-full pl-10 pr-3 py-2 rounded-md bg-slate-700/60 text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition\",\n            placeholder: \"Search users...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto\",\n        children: renderUsers()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-1 flex flex-col\",\n      children: selectedUser ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-slate-800\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [getAvatar(selectedUser.username, 2.5), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-semibold text-lg text-white\",\n                children: selectedUser.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-2 text-xs text-gray-400\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `w-2 h-2 rounded-full ${selectedUser.isOnline ? 'bg-green-400' : 'bg-gray-500'}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: selectedUser.isOnline ? 'Online' : 'Offline'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"p-2 rounded-full hover:bg-slate-800 transition flex-shrink-0\",\n              children: /*#__PURE__*/_jsxDEV(PhoneIcon, {\n                className: \"w-5 h-5 text-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"p-2 rounded-full hover:bg-slate-800 transition flex-shrink-0\",\n              children: /*#__PURE__*/_jsxDEV(EllipsisVerticalIcon, {\n                className: \"w-5 h-5 text-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 bg-slate-900\",\n          children: renderMessages()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: sendMessage,\n          className: \"px-6 py-4 bg-slate-800 border-t border-slate-800\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-5xl mx-auto flex items-end gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"p-2 rounded-lg hover:bg-slate-700 transition\",\n                children: /*#__PURE__*/_jsxDEV(FaceSmileIcon, {\n                  className: \"w-6 h-6 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"p-2 rounded-lg hover:bg-slate-700 transition\",\n                children: /*#__PURE__*/_jsxDEV(PaperClipIcon, {\n                  className: \"w-6 h-6 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              ref: textareaRef,\n              value: input,\n              onChange: e => setInput(e.target.value),\n              onInput: autoGrowTextarea,\n              placeholder: `Message ${selectedUser.username}...`,\n              rows: 1,\n              className: \"flex-1 resize-none bg-slate-700/70 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition placeholder-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                disabled: loading || !input.trim(),\n                className: `p-3 rounded-full bg-indigo-600 hover:bg-indigo-700 transition shadow-lg flex items-center justify-center ${!input.trim() || loading ? 'opacity-60 cursor-not-allowed' : ''}`,\n                children: /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n                  className: \"w-5 h-5 text-white rotate-90\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center h-full text-gray-400\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-2xl font-bold mb-2\",\n          children: \"Welcome to SecureChat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-lg\",\n          children: \"Select a user to start chatting.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 216,\n    columnNumber: 5\n  }, this);\n};\n\n// MessageItem component with bubble styling and preserved decryption behaviour\n_s(ChatContainer, \"426eAwCkRxjVVN/IsFkUU/SvGRA=\");\n_c = ChatContainer;\nconst MessageItem = ({\n  msg,\n  currentUser,\n  getDecryptedPrivateKey\n}) => {\n  _s2();\n  const [decrypted, setDecrypted] = useState('');\n  const [isDecrypting, setIsDecrypting] = useState(false);\n  useEffect(() => {\n    let mounted = true;\n    const decrypt = async () => {\n      if (msg.from === currentUser.username && msg.plaintext) {\n        if (mounted) setDecrypted(msg.plaintext);\n        return;\n      }\n      setIsDecrypting(true);\n      try {\n        const privateKeyArmored = await getDecryptedPrivateKey();\n        const dec = await hybridDecryptMessage(msg.encryptedContent, msg.encryptedAESKey, privateKeyArmored);\n        if (mounted) setDecrypted(dec);\n      } catch (err) {\n        if (mounted) setDecrypted('[Encrypted]');\n      } finally {\n        if (mounted) setIsDecrypting(false);\n      }\n    };\n    decrypt();\n    return () => {\n      mounted = false;\n    };\n  }, [msg, currentUser]);\n  const isSent = msg.from === currentUser.username;\n  const bubbleBase = 'max-w-[72%] break-words px-4 py-3 rounded-2xl shadow';\n  const bubbleClasses = isSent ? `bg-indigo-600 text-white self-end ${bubbleBase}` : `bg-slate-700 text-gray-100 self-start ${bubbleBase}`;\n  const ts = new Date(msg.timestamp || Date.now());\n  const timeLabel = ts.toLocaleTimeString([], {\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex ${isSent ? 'justify-end' : 'justify-start'} px-2 py-1`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `flex items-end gap-2 ${isSent ? 'flex-row-reverse' : ''}`,\n      children: [!isSent && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-shrink-0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: bubbleClasses,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 text-sm\",\n            children: isDecrypting ? 'Decrypting...' : decrypted\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-shrink-0 ml-2 flex items-center gap-1 text-xs text-gray-200\",\n            children: /*#__PURE__*/_jsxDEV(LockClosedIcon, {\n              className: \"w-4 h-4 opacity-90\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-end mt-2 text-xs text-gray-200 opacity-90\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-1\",\n            children: timeLabel\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 350,\n    columnNumber: 5\n  }, this);\n};\n_s2(MessageItem, \"jyqUiuDNHBGAUzLBNO69JQW823c=\");\n_c2 = MessageItem;\nexport default ChatContainer;\nvar _c, _c2;\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"MessageItem\");","map":{"version":3,"names":["React","useState","useEffect","useRef","usersAPI","messagesAPI","hybridEncryptMessage","hybridDecryptMessage","decryptPrivateKeyAES","getSocket","PaperAirplaneIcon","LockClosedIcon","PhoneIcon","EllipsisVerticalIcon","MagnifyingGlassIcon","FaceSmileIcon","PaperClipIcon","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatContainer","currentUser","showStatus","_s","users","setUsers","selectedUser","setSelectedUser","messages","setMessages","input","setInput","loading","setLoading","decryptedPrivateKeyRef","passphraseRef","messagesEndRef","messageListRef","mounted","getAllUsers","then","res","fetched","data","filter","u","username","map","publicKey","isOnline","lastMessage","catch","getConversation","Array","isArray","socket","handler","msg","from","to","prev","on","off","getDecryptedPrivateKey","current","encryptedPrivateKey","localStorage","getItem","passphrase","window","prompt","privateKeyArmored","err","sendMessage","e","preventDefault","encryptedMessage","encryptedAESKey","messageData","encryptedContent","messageType","outgoing","plaintext","timestamp","Date","now","emit","autoGrowTextarea","t","setTimeout","_messagesEndRef$curre","scrollIntoView","behavior","block","clearTimeout","textareaRef","ta","style","height","Math","min","scrollHeight","getAvatar","size","className","width","background","children","fontSize","slice","toUpperCase","fileName","_jsxFileName","lineNumber","columnNumber","formatPreview","renderUsers","user","onClick","renderMessages","ref","idx","MessageItem","type","placeholder","onSubmit","value","onChange","target","onInput","rows","disabled","trim","_c","_s2","decrypted","setDecrypted","isDecrypting","setIsDecrypting","decrypt","dec","isSent","bubbleBase","bubbleClasses","ts","timeLabel","toLocaleTimeString","hour","minute","_c2","$RefreshReg$"],"sources":["/home/rounak-dagar/securechat/frontend/src/components/Chat/ChatContainer.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { usersAPI, messagesAPI } from '../../services/api';\nimport { hybridEncryptMessage, hybridDecryptMessage, decryptPrivateKeyAES } from '../../services/crypto';\nimport { getSocket } from '../../services/socket';\nimport {\n  PaperAirplaneIcon,\n  LockClosedIcon,\n  PhoneIcon,\n  EllipsisVerticalIcon,\n  MagnifyingGlassIcon,\n  FaceSmileIcon,\n  PaperClipIcon,\n} from '@heroicons/react/24/solid';\n\n// -----------------------------------------------------------------------------\n// ChatContainer (polished UI). Core logic is intentionally preserved (APIs,\n// encryption hooks and socket usage remain the same) while styles/layout are\n// improved for a professional look and reliable behavior.\n// -----------------------------------------------------------------------------\n\nconst ChatContainer = ({ currentUser, showStatus }) => {\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Cache decrypted private key for session\n  const decryptedPrivateKeyRef = useRef(null);\n  const passphraseRef = useRef('');\n\n  // Scroll management\n  const messagesEndRef = useRef(null);\n  const messageListRef = useRef(null);\n\n  useEffect(() => {\n    let mounted = true;\n    usersAPI.getAllUsers().then((res) => {\n      if (!mounted) return;\n      // Filter out current user (if returned) and ensure required fields\n      const fetched = (res.data || []).filter((u) => u.username !== currentUser.username).map((u) => ({\n        username: u.username,\n        publicKey: u.publicKey,\n        isOnline: !!u.isOnline,\n        lastMessage: u.lastMessage || null,\n      }));\n      setUsers(fetched);\n    }).catch(() => {\n      showStatus('Failed to fetch users', 'error');\n    });\n    return () => { mounted = false; };\n  }, [currentUser.username]);\n\n  useEffect(() => {\n    if (!selectedUser) return;\n    messagesAPI.getConversation(selectedUser.username)\n      .then(res => setMessages(Array.isArray(res.data) ? res.data : []))\n      .catch(() => setMessages([]));\n  }, [selectedUser]);\n\n  // Socket receive\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n    const handler = (msg) => {\n      // If the incoming message belongs to current selected conversation, append\n      if (msg.from === selectedUser?.username || msg.to === selectedUser?.username) {\n        setMessages(prev => [...prev, msg]);\n      }\n      // also update user's last online/last message preview in sidebar\n      setUsers(prev => prev.map(u => u.username === (msg.from === currentUser.username ? msg.to : msg.from)\n        ? { ...u, lastMessage: msg } : u\n      ));\n    };\n    socket.on('receive_message', handler);\n    return () => socket.off('receive_message', handler);\n  }, [selectedUser, currentUser.username]);\n\n  // Prompt for password and decrypt private key once per session\n  const getDecryptedPrivateKey = async () => {\n    if (decryptedPrivateKeyRef.current) return decryptedPrivateKeyRef.current;\n    const encryptedPrivateKey = localStorage.getItem('privateKey');\n    let passphrase = passphraseRef.current;\n    if (!passphrase) {\n      passphrase = window.prompt('Enter your password to decrypt your private key:');\n      passphraseRef.current = passphrase;\n    }\n    try {\n      const privateKeyArmored = await decryptPrivateKeyAES(encryptedPrivateKey, passphrase);\n      decryptedPrivateKeyRef.current = privateKeyArmored;\n      return privateKeyArmored;\n    } catch (err) {\n      showStatus('Failed to decrypt private key. Wrong password?', 'error');\n      decryptedPrivateKeyRef.current = null;\n      passphraseRef.current = '';\n      throw err;\n    }\n  };\n\n  const sendMessage = async (e) => {\n    e && e.preventDefault();\n    if (!input || !selectedUser) return;\n    setLoading(true);\n    try {\n      const { encryptedMessage, encryptedAESKey } = await hybridEncryptMessage(input, selectedUser.publicKey);\n      const messageData = {\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      };\n      await messagesAPI.sendMessage(messageData);\n\n      // Add plaintext to local message for sender\n      const outgoing = {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text',\n        plaintext: input,\n        timestamp: Date.now()\n      };\n      setMessages(prev => [...prev, outgoing]);\n\n      getSocket().emit('send_message', {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      });\n\n      // Update sidebar preview\n      setUsers(prev => prev.map(u => u.username === selectedUser.username ? { ...u, lastMessage: outgoing } : u));\n\n      setInput('');\n      autoGrowTextarea();\n      showStatus('Message sent', 'success');\n    } catch (err) {\n      showStatus('Failed to send message', 'error');\n    }\n    setLoading(false);\n  };\n\n  // Keep messages scrolled to bottom (most recent at bottom visually)\n  useEffect(() => {\n    if (!messageListRef.current) return;\n    // A short timeout lets DOM settle\n    const t = setTimeout(() => {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth', block: 'end' });\n    }, 60);\n    return () => clearTimeout(t);\n  }, [messages, selectedUser]);\n\n  // Autosize textarea\n  const textareaRef = useRef(null);\n  const autoGrowTextarea = () => {\n    const ta = textareaRef.current;\n    if (!ta) return;\n    ta.style.height = 'auto';\n    ta.style.height = Math.min(ta.scrollHeight, 160) + 'px';\n  };\n\n  useEffect(() => { autoGrowTextarea(); }, [input]);\n\n  // Small helpers\n  const getAvatar = (username, size = 10) => (\n    <div className={`flex-shrink-0 inline-flex items-center justify-center rounded-full select-none`} style={{ width: `${size}rem`, height: `${size}rem`, background: `linear-gradient(135deg,#7c3aed,#06b6d4)` }}>\n      <span className=\"text-white font-semibold\" style={{ fontSize: `${size / 2}rem` }}>{username.slice(0, 2).toUpperCase()}</span>\n    </div>\n  );\n\n  const formatPreview = (msg) => {\n    if (!msg) return '';\n    if (typeof msg === 'string') return msg;\n    return msg.plaintext || '[Encrypted]';\n  };\n\n  const renderUsers = () => (\n    <ul className=\"space-y-2 mt-4 px-2 pb-6\">\n      {users.map(user => (\n        <li key={user.username}>\n          <button\n            onClick={() => setSelectedUser(user)}\n            className={`w-full flex items-center gap-3 p-3 rounded-xl transition-colors duration-150 text-left ${selectedUser?.username === user.username ? 'bg-slate-700/60' : 'hover:bg-slate-700/30'}`}\n          >\n            <div className=\"relative\">\n              {getAvatar(user.username, 2.5)}\n              <span className={`absolute bottom-0 right-0 block w-3 h-3 rounded-full border-2 border-slate-900 ${user.isOnline ? 'bg-green-400' : 'bg-gray-500'}`} />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"font-semibold truncate mr-2\">{user.username}</div>\n                <div className=\"text-xs text-gray-400\">{/* could show time if available */}</div>\n              </div>\n              <div className=\"text-sm text-gray-300 truncate mt-1\">{formatPreview(user.lastMessage)}</div>\n            </div>\n          </button>\n        </li>\n      ))}\n    </ul>\n  );\n\n  const renderMessages = () => (\n    <div ref={messageListRef} className=\"flex-1 overflow-y-auto px-6 py-4 flex flex-col\">\n      <div className=\"flex-1\" />\n      {messages.map((msg, idx) => (\n        <MessageItem key={idx} msg={msg} currentUser={currentUser} getDecryptedPrivateKey={getDecryptedPrivateKey} />\n      ))}\n      <div ref={messagesEndRef} />\n    </div>\n  );\n\n  return (\n    <div className=\"flex h-screen font-inter bg-slate-900 text-gray-100\">\n      {/* Sidebar */}\n      <aside className=\"flex flex-col w-88 min-w-[20rem] max-w-sm bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 border-r border-slate-800 shadow-lg\">\n        <div className=\"px-6 py-5 border-b border-slate-800 flex flex-col gap-3\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <span className=\"font-extrabold text-2xl tracking-tight text-indigo-400 drop-shadow-lg\">SecureChat</span>\n              <LockClosedIcon style={{ width: 18, height: 18 }} className=\"text-indigo-400\" /> {/* Force small lock icon */}\n            </div>\n            <div className=\"text-xs text-gray-400\">{currentUser.username}</div>\n          </div>\n\n          <div className=\"relative w-full\">\n            <MagnifyingGlassIcon style={{ width: 18, height: 18 }} className=\"absolute left-3 top-3 text-gray-400\" /> {/* Force small magnifying glass */}\n            <input\n              type=\"text\"\n              className=\"w-full pl-10 pr-3 py-2 rounded-md bg-slate-700/60 text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition\"\n              placeholder=\"Search users...\"\n            />\n          </div>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto\">{renderUsers()}</div>\n      </aside>\n\n      {/* Main Chat Area */}\n      <main className=\"flex-1 flex flex-col\">\n        {selectedUser ? (\n          <>\n            {/* Header Bar */}\n            <div className=\"flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-slate-800\">\n              <div className=\"flex items-center gap-3\">\n                {getAvatar(selectedUser.username, 2.5)}\n                <div>\n                  <div className=\"font-semibold text-lg text-white\">{selectedUser.username}</div>\n                  <div className=\"flex items-center gap-2 text-xs text-gray-400\">\n                    <span className={`w-2 h-2 rounded-full ${selectedUser.isOnline ? 'bg-green-400' : 'bg-gray-500'}`} />\n                    <span>{selectedUser.isOnline ? 'Online' : 'Offline'}</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <button className=\"p-2 rounded-full hover:bg-slate-800 transition flex-shrink-0\">\n                  <PhoneIcon className=\"w-5 h-5 text-gray-300\" />\n                </button>\n                <button className=\"p-2 rounded-full hover:bg-slate-800 transition flex-shrink-0\">\n                  <EllipsisVerticalIcon className=\"w-5 h-5 text-gray-300\" />\n                </button>\n              </div>\n            </div>\n\n            {/* Message List */}\n            <div className=\"flex-1 bg-slate-900\">{renderMessages()}</div>\n\n            {/* Composer */}\n            <form onSubmit={sendMessage} className=\"px-6 py-4 bg-slate-800 border-t border-slate-800\">\n              <div className=\"max-w-5xl mx-auto flex items-end gap-3\">\n                <div className=\"flex items-center gap-2\">\n                  <button type=\"button\" className=\"p-2 rounded-lg hover:bg-slate-700 transition\">\n                    <FaceSmileIcon className=\"w-6 h-6 text-gray-300\" />\n                  </button>\n                  <button type=\"button\" className=\"p-2 rounded-lg hover:bg-slate-700 transition\">\n                    <PaperClipIcon className=\"w-6 h-6 text-gray-300\" />\n                  </button>\n                </div>\n\n                <textarea\n                  ref={textareaRef}\n                  value={input}\n                  onChange={e => setInput(e.target.value)}\n                  onInput={autoGrowTextarea}\n                  placeholder={`Message ${selectedUser.username}...`}\n                  rows={1}\n                  className=\"flex-1 resize-none bg-slate-700/70 text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition placeholder-gray-400\"\n                />\n\n                <div className=\"flex items-center gap-2\">\n                  <button\n                    type=\"submit\"\n                    disabled={loading || !input.trim()}\n                    className={`p-3 rounded-full bg-indigo-600 hover:bg-indigo-700 transition shadow-lg flex items-center justify-center ${(!input.trim() || loading) ? 'opacity-60 cursor-not-allowed' : ''}`}\n                  >\n                    <PaperAirplaneIcon className=\"w-5 h-5 text-white rotate-90\" />\n                  </button>\n                </div>\n              </div>\n            </form>\n          </>\n        ) : (\n          <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\n            <span className=\"text-2xl font-bold mb-2\">Welcome to SecureChat</span>\n            <span className=\"text-lg\">Select a user to start chatting.</span>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n};\n\n// MessageItem component with bubble styling and preserved decryption behaviour\nconst MessageItem = ({ msg, currentUser, getDecryptedPrivateKey }) => {\n  const [decrypted, setDecrypted] = useState('');\n  const [isDecrypting, setIsDecrypting] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    const decrypt = async () => {\n      if (msg.from === currentUser.username && msg.plaintext) {\n        if (mounted) setDecrypted(msg.plaintext);\n        return;\n      }\n      setIsDecrypting(true);\n      try {\n        const privateKeyArmored = await getDecryptedPrivateKey();\n        const dec = await hybridDecryptMessage(msg.encryptedContent, msg.encryptedAESKey, privateKeyArmored);\n        if (mounted) setDecrypted(dec);\n      } catch (err) {\n        if (mounted) setDecrypted('[Encrypted]');\n      } finally {\n        if (mounted) setIsDecrypting(false);\n      }\n    };\n    decrypt();\n    return () => { mounted = false; };\n  }, [msg, currentUser]);\n\n  const isSent = msg.from === currentUser.username;\n  const bubbleBase = 'max-w-[72%] break-words px-4 py-3 rounded-2xl shadow';\n  const bubbleClasses = isSent ? `bg-indigo-600 text-white self-end ${bubbleBase}` : `bg-slate-700 text-gray-100 self-start ${bubbleBase}`;\n  const ts = new Date(msg.timestamp || Date.now());\n  const timeLabel = ts.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n\n  return (\n    <div className={`flex ${isSent ? 'justify-end' : 'justify-start'} px-2 py-1`}> \n      <div className={`flex items-end gap-2 ${isSent ? 'flex-row-reverse' : ''}`}>\n        {/* Optional avatar for incoming messages */}\n        {!isSent && <div className=\"flex-shrink-0\">{/* small placeholder or avatar */}</div>}\n\n        <div className={bubbleClasses}>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"flex-1 text-sm\">{isDecrypting ? 'Decrypting...' : decrypted}</div>\n            <div className=\"flex-shrink-0 ml-2 flex items-center gap-1 text-xs text-gray-200\">\n              <LockClosedIcon className=\"w-4 h-4 opacity-90\" />\n            </div>\n          </div>\n          <div className=\"flex items-center justify-end mt-2 text-xs text-gray-200 opacity-90\">\n            <span className=\"mr-1\">{timeLabel}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatContainer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}