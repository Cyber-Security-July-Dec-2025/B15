{"ast":null,"code":"var _jsxFileName = \"/home/rounak-dagar/securechat/frontend/src/components/Chat/ChatContainer.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { usersAPI, messagesAPI } from '../../services/api';\nimport { hybridEncryptMessage, hybridDecryptMessage, decryptPrivateKeyAES } from '../../services/crypto';\nimport { getSocket } from '../../services/socket';\nimport { PaperAirplaneIcon, LockClosedIcon, PhoneIcon, EllipsisVerticalIcon, MagnifyingGlassIcon, FaceSmileIcon, PaperClipIcon, CameraIcon, MicrophoneIcon, CheckIcon, ArrowLeftIcon } from '@heroicons/react/24/solid';\n\n// -----------------------------------------------------------------------------\n// WhatsApp-like Chat UI (fixed layout wrappings)\n// - preserves original encryption + socket logic\n// - updated layout to prevent contact list shrink / chat dropping under list\n// -----------------------------------------------------------------------------\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst WA_GREEN = '#25D366';\nconst WA_BACKGROUND = 'bg-[#ECE5DD]';\nconst ChatContainer = ({\n  currentUser,\n  showStatus\n}) => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Cache decrypted private key for session\n  const decryptedPrivateKeyRef = useRef(null);\n  const passphraseRef = useRef('');\n\n  // Scroll management\n  const messagesEndRef = useRef(null);\n  const messageListRef = useRef(null);\n  useEffect(() => {\n    let mounted = true;\n    usersAPI.getAllUsers().then(res => {\n      if (!mounted) return;\n      const fetched = (res.data || []).filter(u => u.username !== currentUser.username).map(u => ({\n        username: u.username,\n        publicKey: u.publicKey,\n        isOnline: !!u.isOnline,\n        lastMessage: u.lastMessage || null,\n        unread: u.unread || 0\n      }));\n      setUsers(fetched);\n    }).catch(() => {\n      showStatus('Failed to fetch users', 'error');\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [currentUser.username]);\n  useEffect(() => {\n    if (!selectedUser) return;\n    messagesAPI.getConversation(selectedUser.username).then(res => setMessages(Array.isArray(res.data) ? res.data : [])).catch(() => setMessages([]));\n  }, [selectedUser]);\n\n  // Socket receive\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n    const handler = msg => {\n      if (msg.from === (selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username) || msg.to === (selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username)) {\n        setMessages(prev => [...prev, msg]);\n      }\n      setUsers(prev => prev.map(u => u.username === (msg.from === currentUser.username ? msg.to : msg.from) ? {\n        ...u,\n        lastMessage: msg,\n        unread: msg.to === currentUser.username ? (u.unread || 0) + 1 : u.unread\n      } : u));\n    };\n    socket.on('receive_message', handler);\n    return () => socket.off('receive_message', handler);\n  }, [selectedUser, currentUser.username]);\n\n  // Prompt for password and decrypt private key once per session\n  const getDecryptedPrivateKey = async () => {\n    if (decryptedPrivateKeyRef.current) return decryptedPrivateKeyRef.current;\n    const encryptedPrivateKey = localStorage.getItem('privateKey');\n    let passphrase = passphraseRef.current;\n    if (!passphrase) {\n      passphrase = window.prompt('Enter your password to decrypt your private key:');\n      passphraseRef.current = passphrase;\n    }\n    try {\n      const privateKeyArmored = await decryptPrivateKeyAES(encryptedPrivateKey, passphrase);\n      decryptedPrivateKeyRef.current = privateKeyArmored;\n      return privateKeyArmored;\n    } catch (err) {\n      showStatus('Failed to decrypt private key. Wrong password?', 'error');\n      decryptedPrivateKeyRef.current = null;\n      passphraseRef.current = '';\n      throw err;\n    }\n  };\n  const sendMessage = async e => {\n    e && e.preventDefault();\n    if (!selectedUser) return;\n    const trimmed = input.trim();\n    if (!trimmed) return;\n    setLoading(true);\n    try {\n      const {\n        encryptedMessage,\n        encryptedAESKey\n      } = await hybridEncryptMessage(trimmed, selectedUser.publicKey);\n      const messageData = {\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      };\n      await messagesAPI.sendMessage(messageData);\n      const outgoing = {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text',\n        plaintext: trimmed,\n        timestamp: Date.now(),\n        sent: true,\n        delivered: false,\n        read: false\n      };\n      setMessages(prev => [...prev, outgoing]);\n      getSocket().emit('send_message', {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      });\n      setUsers(prev => prev.map(u => u.username === selectedUser.username ? {\n        ...u,\n        lastMessage: outgoing\n      } : u));\n      setInput('');\n      autoGrowTextarea();\n      showStatus('Message sent', 'success');\n    } catch (err) {\n      showStatus('Failed to send message', 'error');\n    }\n    setLoading(false);\n  };\n\n  // Keep messages scrolled to bottom\n  useEffect(() => {\n    if (!messageListRef.current) return;\n    const t = setTimeout(() => {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: 'smooth',\n        block: 'end'\n      });\n    }, 50);\n    return () => clearTimeout(t);\n  }, [messages, selectedUser]);\n\n  // Autosize textarea\n  const textareaRef = useRef(null);\n  const autoGrowTextarea = () => {\n    const ta = textareaRef.current;\n    if (!ta) return;\n    ta.style.height = 'auto';\n    ta.style.height = Math.min(ta.scrollHeight, 160) + 'px';\n  };\n  useEffect(() => {\n    autoGrowTextarea();\n  }, [input]);\n\n  // Small helpers\n  const getAvatar = (username, size = 10) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex-shrink-0 inline-flex items-center justify-center rounded-full select-none`,\n    style: {\n      width: `${size}rem`,\n      height: `${size}rem`,\n      background: `linear-gradient(135deg,#34d399,#059669)`\n    },\n    children: /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"text-white font-semibold\",\n      style: {\n        fontSize: `${size / 2}rem`\n      },\n      children: username.slice(0, 2).toUpperCase()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 175,\n    columnNumber: 5\n  }, this);\n  const timeOnly = ts => new Date(ts || Date.now()).toLocaleTimeString([], {\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n  const renderUsers = () => /*#__PURE__*/_jsxDEV(\"ul\", {\n    className: \"divide-y divide-slate-700\",\n    children: users.map(user => {\n      var _user$lastMessage, _user$lastMessage2;\n      return /*#__PURE__*/_jsxDEV(\"li\", {\n        className: `px-3 py-3 hover:bg-slate-800/30 ${(selectedUser === null || selectedUser === void 0 ? void 0 : selectedUser.username) === user.username ? 'bg-slate-800/40' : ''}`,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setSelectedUser(user),\n          className: \"w-full flex items-center gap-3 text-left\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [getAvatar(user.username, 2.2), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `absolute bottom-0 right-0 block w-3 h-3 rounded-full border-2 border-slate-900 ${user.isOnline ? 'bg-green-400' : 'bg-gray-500'}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 min-w-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-semibold truncate\",\n                children: user.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-400 ml-2\",\n                children: (_user$lastMessage = user.lastMessage) !== null && _user$lastMessage !== void 0 && _user$lastMessage.timestamp ? timeOnly(user.lastMessage.timestamp) : ''\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-300 truncate mt-1 flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"truncate\",\n                children: ((_user$lastMessage2 = user.lastMessage) === null || _user$lastMessage2 === void 0 ? void 0 : _user$lastMessage2.plaintext) || '[Encrypted]'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 17\n              }, this), user.unread > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-2 inline-flex items-center justify-center bg-green-500 text-white text-xs font-semibold rounded-full px-2 py-0.5\",\n                children: user.unread\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this)\n      }, user.username, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 5\n  }, this);\n\n  // KEY LAYOUT FIXES:\n  // - root container has flex-nowrap so columns don't wrap\n  // - sidebar has a larger fixed width and flex-shrink-0 so it won't collapse\n  // - main content has min-w-0 to allow proper shrinking inside flex container\n  // - message list wrapper has min-h-0 so overflow works correctly\n\n  const renderMessages = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: messageListRef,\n    className: `flex-1 overflow-y-auto px-6 py-6 ${WA_BACKGROUND} min-h-0`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-3xl mx-auto flex flex-col gap-3\",\n      children: [messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(WAChatBubble, {\n        msg: msg,\n        currentUser: currentUser,\n        getDecryptedPrivateKey: getDecryptedPrivateKey\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 214,\n    columnNumber: 5\n  }, this);\n  return (\n    /*#__PURE__*/\n    // Added flex-nowrap and ensured children prevent unwanted wrapping\n    _jsxDEV(\"div\", {\n      className: \"flex h-screen font-inter text-gray-900 flex-nowrap\",\n      children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n        className: \"flex flex-col w-96 min-w-[22rem] max-w-[28rem] flex-shrink-0 bg-[#111b21] text-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between px-4 py-3 border-b border-slate-800\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [getAvatar(currentUser.username, 2.3), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-semibold text-white\",\n                children: currentUser.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-400\",\n                children: \"Tap to change status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"p-2 rounded-full hover:bg-slate-800/30\",\n              children: /*#__PURE__*/_jsxDEV(MagnifyingGlassIcon, {\n                className: \"w-5 h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 72\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"p-2 rounded-full hover:bg-slate-800/30\",\n              children: /*#__PURE__*/_jsxDEV(EllipsisVerticalIcon, {\n                className: \"w-5 h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 72\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-4 py-3\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(MagnifyingGlassIcon, {\n              className: \"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"w-full pl-10 pr-3 py-2 rounded-full bg-[#202c33] text-gray-200 placeholder-gray-400 focus:outline-none\",\n              placeholder: \"Search or start new chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-auto min-h-0\",\n          children: renderUsers()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-1 flex flex-col bg-[#0b1416] min-w-0\",\n        children: selectedUser ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between px-4 py-3 bg-[#0b1416] border-b border-slate-800\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setSelectedUser(null),\n                className: \"p-2 rounded-full hover:bg-slate-800/20 md:hidden\",\n                children: /*#__PURE__*/_jsxDEV(ArrowLeftIcon, {\n                  className: \"w-5 h-5 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 124\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 17\n              }, this), getAvatar(selectedUser.username, 2.2), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-semibold text-white\",\n                  children: selectedUser.username\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-gray-400\",\n                  children: selectedUser.isOnline ? 'online' : 'last seen recently'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"p-2 rounded-full hover:bg-slate-800/20\",\n                children: /*#__PURE__*/_jsxDEV(PhoneIcon, {\n                  className: \"w-5 h-5 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 76\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"p-2 rounded-full hover:bg-slate-800/20\",\n                children: /*#__PURE__*/_jsxDEV(CameraIcon, {\n                  className: \"w-5 h-5 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 76\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"p-2 rounded-full hover:bg-slate-800/20\",\n                children: /*#__PURE__*/_jsxDEV(EllipsisVerticalIcon, {\n                  className: \"w-5 h-5 text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 76\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this), renderMessages(), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: sendMessage,\n            className: \"px-4 py-3 bg-[#111b21] border-t border-slate-800\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"max-w-3xl mx-auto flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"p-2 rounded-full hover:bg-slate-800/20\",\n                children: /*#__PURE__*/_jsxDEV(FaceSmileIcon, {\n                  className: \"w-6 h-6 text-gray-200\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 90\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"p-2 rounded-full hover:bg-slate-800/20\",\n                children: /*#__PURE__*/_jsxDEV(PaperClipIcon, {\n                  className: \"w-6 h-6 text-gray-200\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 90\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                ref: textareaRef,\n                value: input,\n                onChange: e => setInput(e.target.value),\n                onInput: autoGrowTextarea,\n                placeholder: `Message ${selectedUser.username}`,\n                rows: 1,\n                className: \"flex-1 resize-none rounded-full px-4 py-2 bg-white/95 text-black focus:outline-none\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 17\n              }, this), input.trim().length > 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                disabled: loading,\n                className: \"p-3 rounded-full\",\n                style: {\n                  background: WA_GREEN\n                },\n                children: /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n                  className: \"w-5 h-5 text-white rotate-90\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"p-3 rounded-full bg-[#1f2a2b] hover:bg-[#2b3737]\",\n                children: /*#__PURE__*/_jsxDEV(MicrophoneIcon, {\n                  className: \"w-5 h-5 text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex-1 flex items-center justify-center ${WA_BACKGROUND}`,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center text-gray-700\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl font-semibold mb-2\",\n              children: \"Keep your phone connected\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm\",\n              children: \"WhatsApp connects to your phone to sync messages. To send and receive messages, keep your phone connected.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 5\n    }, this)\n  );\n};\n\n// WhatsApp-like chat bubble component\n_s(ChatContainer, \"426eAwCkRxjVVN/IsFkUU/SvGRA=\");\n_c = ChatContainer;\nconst WAChatBubble = ({\n  msg,\n  currentUser,\n  getDecryptedPrivateKey\n}) => {\n  _s2();\n  const [decrypted, setDecrypted] = useState('');\n  const [isDecrypting, setIsDecrypting] = useState(false);\n  useEffect(() => {\n    let mounted = true;\n    const decrypt = async () => {\n      if (msg.from === currentUser.username && msg.plaintext) {\n        if (mounted) setDecrypted(msg.plaintext);\n        return;\n      }\n      setIsDecrypting(true);\n      try {\n        const privateKeyArmored = await getDecryptedPrivateKey();\n        const dec = await hybridDecryptMessage(msg.encryptedContent, msg.encryptedAESKey, privateKeyArmored);\n        if (mounted) setDecrypted(dec);\n      } catch (err) {\n        if (mounted) setDecrypted('[Encrypted]');\n      } finally {\n        if (mounted) setIsDecrypting(false);\n      }\n    };\n    decrypt();\n    return () => {\n      mounted = false;\n    };\n  }, [msg, currentUser]);\n  const isSent = msg.from === currentUser.username;\n  const timeLabel = new Date(msg.timestamp || Date.now()).toLocaleTimeString([], {\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n\n  // WhatsApp colours: incoming = white, outgoing = green\n  if (isSent) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"self-end flex items-end gap-2 max-w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-end\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rounded-bl-2xl rounded-tl-2xl rounded-tr-xl px-4 py-2\",\n          style: {\n            background: WA_GREEN,\n            color: 'white'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm leading-relaxed\",\n            children: isDecrypting ? 'Decrypting...' : decrypted\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-200 mt-1 flex items-center gap-1 justify-end\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: timeLabel\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CheckIcon, {\n            className: \"w-4 h-4 text-white opacity-90\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"self-start flex items-start gap-3 max-w-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-shrink-0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rounded-br-2xl rounded-tr-2xl rounded-tl-xl px-4 py-2 bg-white text-gray-900\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm leading-relaxed\",\n          children: isDecrypting ? 'Decrypting...' : decrypted\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-400 mt-1\",\n        children: timeLabel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 368,\n    columnNumber: 5\n  }, this);\n};\n_s2(WAChatBubble, \"jyqUiuDNHBGAUzLBNO69JQW823c=\");\n_c2 = WAChatBubble;\nexport default ChatContainer;\nvar _c, _c2;\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"WAChatBubble\");","map":{"version":3,"names":["React","useState","useEffect","useRef","usersAPI","messagesAPI","hybridEncryptMessage","hybridDecryptMessage","decryptPrivateKeyAES","getSocket","PaperAirplaneIcon","LockClosedIcon","PhoneIcon","EllipsisVerticalIcon","MagnifyingGlassIcon","FaceSmileIcon","PaperClipIcon","CameraIcon","MicrophoneIcon","CheckIcon","ArrowLeftIcon","jsxDEV","_jsxDEV","Fragment","_Fragment","WA_GREEN","WA_BACKGROUND","ChatContainer","currentUser","showStatus","_s","users","setUsers","selectedUser","setSelectedUser","messages","setMessages","input","setInput","loading","setLoading","decryptedPrivateKeyRef","passphraseRef","messagesEndRef","messageListRef","mounted","getAllUsers","then","res","fetched","data","filter","u","username","map","publicKey","isOnline","lastMessage","unread","catch","getConversation","Array","isArray","socket","handler","msg","from","to","prev","on","off","getDecryptedPrivateKey","current","encryptedPrivateKey","localStorage","getItem","passphrase","window","prompt","privateKeyArmored","err","sendMessage","e","preventDefault","trimmed","trim","encryptedMessage","encryptedAESKey","messageData","encryptedContent","messageType","outgoing","plaintext","timestamp","Date","now","sent","delivered","read","emit","autoGrowTextarea","t","setTimeout","_messagesEndRef$curre","scrollIntoView","behavior","block","clearTimeout","textareaRef","ta","style","height","Math","min","scrollHeight","getAvatar","size","className","width","background","children","fontSize","slice","toUpperCase","fileName","_jsxFileName","lineNumber","columnNumber","timeOnly","ts","toLocaleTimeString","hour","minute","renderUsers","user","_user$lastMessage","_user$lastMessage2","onClick","renderMessages","ref","idx","WAChatBubble","placeholder","onSubmit","type","value","onChange","target","onInput","rows","length","disabled","_c","_s2","decrypted","setDecrypted","isDecrypting","setIsDecrypting","decrypt","dec","isSent","timeLabel","color","_c2","$RefreshReg$"],"sources":["/home/rounak-dagar/securechat/frontend/src/components/Chat/ChatContainer.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { usersAPI, messagesAPI } from '../../services/api';\nimport { hybridEncryptMessage, hybridDecryptMessage, decryptPrivateKeyAES } from '../../services/crypto';\nimport { getSocket } from '../../services/socket';\nimport {\n  PaperAirplaneIcon,\n  LockClosedIcon,\n  PhoneIcon,\n  EllipsisVerticalIcon,\n  MagnifyingGlassIcon,\n  FaceSmileIcon,\n  PaperClipIcon,\n  CameraIcon,\n  MicrophoneIcon,\n  CheckIcon,\n  ArrowLeftIcon,\n} from '@heroicons/react/24/solid';\n\n// -----------------------------------------------------------------------------\n// WhatsApp-like Chat UI (fixed layout wrappings)\n// - preserves original encryption + socket logic\n// - updated layout to prevent contact list shrink / chat dropping under list\n// -----------------------------------------------------------------------------\n\nconst WA_GREEN = '#25D366';\nconst WA_BACKGROUND = 'bg-[#ECE5DD]';\n\nconst ChatContainer = ({ currentUser, showStatus }) => {\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Cache decrypted private key for session\n  const decryptedPrivateKeyRef = useRef(null);\n  const passphraseRef = useRef('');\n\n  // Scroll management\n  const messagesEndRef = useRef(null);\n  const messageListRef = useRef(null);\n\n  useEffect(() => {\n    let mounted = true;\n    usersAPI.getAllUsers().then((res) => {\n      if (!mounted) return;\n      const fetched = (res.data || []).filter((u) => u.username !== currentUser.username).map((u) => ({\n        username: u.username,\n        publicKey: u.publicKey,\n        isOnline: !!u.isOnline,\n        lastMessage: u.lastMessage || null,\n        unread: u.unread || 0,\n      }));\n      setUsers(fetched);\n    }).catch(() => {\n      showStatus('Failed to fetch users', 'error');\n    });\n    return () => { mounted = false; };\n  }, [currentUser.username]);\n\n  useEffect(() => {\n    if (!selectedUser) return;\n    messagesAPI.getConversation(selectedUser.username)\n      .then(res => setMessages(Array.isArray(res.data) ? res.data : []))\n      .catch(() => setMessages([]));\n  }, [selectedUser]);\n\n  // Socket receive\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n    const handler = (msg) => {\n      if (msg.from === selectedUser?.username || msg.to === selectedUser?.username) {\n        setMessages(prev => [...prev, msg]);\n      }\n      setUsers(prev => prev.map(u => u.username === (msg.from === currentUser.username ? msg.to : msg.from)\n        ? { ...u, lastMessage: msg, unread: msg.to === currentUser.username ? (u.unread || 0) + 1 : u.unread } : u\n      ));\n    };\n    socket.on('receive_message', handler);\n    return () => socket.off('receive_message', handler);\n  }, [selectedUser, currentUser.username]);\n\n  // Prompt for password and decrypt private key once per session\n  const getDecryptedPrivateKey = async () => {\n    if (decryptedPrivateKeyRef.current) return decryptedPrivateKeyRef.current;\n    const encryptedPrivateKey = localStorage.getItem('privateKey');\n    let passphrase = passphraseRef.current;\n    if (!passphrase) {\n      passphrase = window.prompt('Enter your password to decrypt your private key:');\n      passphraseRef.current = passphrase;\n    }\n    try {\n      const privateKeyArmored = await decryptPrivateKeyAES(encryptedPrivateKey, passphrase);\n      decryptedPrivateKeyRef.current = privateKeyArmored;\n      return privateKeyArmored;\n    } catch (err) {\n      showStatus('Failed to decrypt private key. Wrong password?', 'error');\n      decryptedPrivateKeyRef.current = null;\n      passphraseRef.current = '';\n      throw err;\n    }\n  };\n\n  const sendMessage = async (e) => {\n    e && e.preventDefault();\n    if (!selectedUser) return;\n    const trimmed = input.trim();\n    if (!trimmed) return;\n    setLoading(true);\n    try {\n      const { encryptedMessage, encryptedAESKey } = await hybridEncryptMessage(trimmed, selectedUser.publicKey);\n      const messageData = {\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      };\n      await messagesAPI.sendMessage(messageData);\n\n      const outgoing = {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text',\n        plaintext: trimmed,\n        timestamp: Date.now(),\n        sent: true,\n        delivered: false,\n        read: false,\n      };\n      setMessages(prev => [...prev, outgoing]);\n\n      getSocket().emit('send_message', {\n        from: currentUser.username,\n        to: selectedUser.username,\n        encryptedContent: encryptedMessage,\n        encryptedAESKey,\n        messageType: 'text'\n      });\n\n      setUsers(prev => prev.map(u => u.username === selectedUser.username ? { ...u, lastMessage: outgoing } : u));\n\n      setInput('');\n      autoGrowTextarea();\n      showStatus('Message sent', 'success');\n    } catch (err) {\n      showStatus('Failed to send message', 'error');\n    }\n    setLoading(false);\n  };\n\n  // Keep messages scrolled to bottom\n  useEffect(() => {\n    if (!messageListRef.current) return;\n    const t = setTimeout(() => {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth', block: 'end' });\n    }, 50);\n    return () => clearTimeout(t);\n  }, [messages, selectedUser]);\n\n  // Autosize textarea\n  const textareaRef = useRef(null);\n  const autoGrowTextarea = () => {\n    const ta = textareaRef.current;\n    if (!ta) return;\n    ta.style.height = 'auto';\n    ta.style.height = Math.min(ta.scrollHeight, 160) + 'px';\n  };\n  useEffect(() => { autoGrowTextarea(); }, [input]);\n\n  // Small helpers\n  const getAvatar = (username, size = 10) => (\n    <div className={`flex-shrink-0 inline-flex items-center justify-center rounded-full select-none`} style={{ width: `${size}rem`, height: `${size}rem`, background: `linear-gradient(135deg,#34d399,#059669)` }}>\n      <span className=\"text-white font-semibold\" style={{ fontSize: `${size / 2}rem` }}>{username.slice(0, 2).toUpperCase()}</span>\n    </div>\n  );\n\n  const timeOnly = (ts) => new Date(ts || Date.now()).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n\n  const renderUsers = () => (\n    <ul className=\"divide-y divide-slate-700\">\n      {users.map(user => (\n        <li key={user.username} className={`px-3 py-3 hover:bg-slate-800/30 ${selectedUser?.username === user.username ? 'bg-slate-800/40' : ''}`}>\n          <button onClick={() => setSelectedUser(user)} className=\"w-full flex items-center gap-3 text-left\">\n            <div className=\"relative\">\n              {getAvatar(user.username, 2.2)}\n              <span className={`absolute bottom-0 right-0 block w-3 h-3 rounded-full border-2 border-slate-900 ${user.isOnline ? 'bg-green-400' : 'bg-gray-500'}`} />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"font-semibold truncate\">{user.username}</div>\n                <div className=\"text-xs text-gray-400 ml-2\">{user.lastMessage?.timestamp ? timeOnly(user.lastMessage.timestamp) : ''}</div>\n              </div>\n              <div className=\"text-sm text-gray-300 truncate mt-1 flex items-center gap-2\">\n                <span className=\"truncate\">{user.lastMessage?.plaintext || '[Encrypted]'}</span>\n                {user.unread > 0 && <span className=\"ml-2 inline-flex items-center justify-center bg-green-500 text-white text-xs font-semibold rounded-full px-2 py-0.5\">{user.unread}</span>}\n              </div>\n            </div>\n          </button>\n        </li>\n      ))}\n    </ul>\n  );\n\n  // KEY LAYOUT FIXES:\n  // - root container has flex-nowrap so columns don't wrap\n  // - sidebar has a larger fixed width and flex-shrink-0 so it won't collapse\n  // - main content has min-w-0 to allow proper shrinking inside flex container\n  // - message list wrapper has min-h-0 so overflow works correctly\n\n  const renderMessages = () => (\n    <div ref={messageListRef} className={`flex-1 overflow-y-auto px-6 py-6 ${WA_BACKGROUND} min-h-0`}>\n      <div className=\"max-w-3xl mx-auto flex flex-col gap-3\">\n        {messages.map((msg, idx) => (\n          <WAChatBubble key={idx} msg={msg} currentUser={currentUser} getDecryptedPrivateKey={getDecryptedPrivateKey} />\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n    </div>\n  );\n\n  return (\n    // Added flex-nowrap and ensured children prevent unwanted wrapping\n    <div className=\"flex h-screen font-inter text-gray-900 flex-nowrap\">\n      {/* Left sidebar - WhatsApp-like */}\n      <aside className=\"flex flex-col w-96 min-w-[22rem] max-w-[28rem] flex-shrink-0 bg-[#111b21] text-gray-200\">\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-slate-800\">\n          <div className=\"flex items-center gap-3\">\n            {getAvatar(currentUser.username, 2.3)}\n            <div className=\"text-sm\">\n              <div className=\"font-semibold text-white\">{currentUser.username}</div>\n              <div className=\"text-xs text-gray-400\">Tap to change status</div>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button className=\"p-2 rounded-full hover:bg-slate-800/30\"><MagnifyingGlassIcon className=\"w-5 h-5\" /></button>\n            <button className=\"p-2 rounded-full hover:bg-slate-800/30\"><EllipsisVerticalIcon className=\"w-5 h-5\" /></button>\n          </div>\n        </div>\n\n        <div className=\"px-4 py-3\">\n          <div className=\"relative\">\n            <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\n            <input className=\"w-full pl-10 pr-3 py-2 rounded-full bg-[#202c33] text-gray-200 placeholder-gray-400 focus:outline-none\" placeholder=\"Search or start new chat\" />\n          </div>\n        </div>\n\n        <div className=\"flex-1 overflow-auto min-h-0\">\n          {renderUsers()}\n        </div>\n      </aside>\n\n      {/* Main chat area */}\n      <main className=\"flex-1 flex flex-col bg-[#0b1416] min-w-0\">\n        {selectedUser ? (\n          <>\n            <div className=\"flex items-center justify-between px-4 py-3 bg-[#0b1416] border-b border-slate-800\">\n              <div className=\"flex items-center gap-3\">\n                <button onClick={() => setSelectedUser(null)} className=\"p-2 rounded-full hover:bg-slate-800/20 md:hidden\"><ArrowLeftIcon className=\"w-5 h-5 text-gray-300\" /></button>\n                {getAvatar(selectedUser.username, 2.2)}\n                <div className=\"flex flex-col\">\n                  <div className=\"font-semibold text-white\">{selectedUser.username}</div>\n                  <div className=\"text-xs text-gray-400\">{selectedUser.isOnline ? 'online' : 'last seen recently'}</div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <button className=\"p-2 rounded-full hover:bg-slate-800/20\"><PhoneIcon className=\"w-5 h-5 text-gray-300\" /></button>\n                <button className=\"p-2 rounded-full hover:bg-slate-800/20\"><CameraIcon className=\"w-5 h-5 text-gray-300\" /></button>\n                <button className=\"p-2 rounded-full hover:bg-slate-800/20\"><EllipsisVerticalIcon className=\"w-5 h-5 text-gray-300\" /></button>\n              </div>\n            </div>\n\n            {renderMessages()}\n\n            {/* Composer like WhatsApp */}\n            <form onSubmit={sendMessage} className=\"px-4 py-3 bg-[#111b21] border-t border-slate-800\">\n              <div className=\"max-w-3xl mx-auto flex items-center gap-3\">\n                <button type=\"button\" className=\"p-2 rounded-full hover:bg-slate-800/20\"><FaceSmileIcon className=\"w-6 h-6 text-gray-200\" /></button>\n                <button type=\"button\" className=\"p-2 rounded-full hover:bg-slate-800/20\"><PaperClipIcon className=\"w-6 h-6 text-gray-200\" /></button>\n\n                <textarea\n                  ref={textareaRef}\n                  value={input}\n                  onChange={e => setInput(e.target.value)}\n                  onInput={autoGrowTextarea}\n                  placeholder={`Message ${selectedUser.username}`}\n                  rows={1}\n                  className=\"flex-1 resize-none rounded-full px-4 py-2 bg-white/95 text-black focus:outline-none\"\n                />\n\n                {/* Toggle mic/send */}\n                {input.trim().length > 0 ? (\n                  <button type=\"submit\" disabled={loading} className=\"p-3 rounded-full\" style={{ background: WA_GREEN }}>\n                    <PaperAirplaneIcon className=\"w-5 h-5 text-white rotate-90\" />\n                  </button>\n                ) : (\n                  <button type=\"button\" className=\"p-3 rounded-full bg-[#1f2a2b] hover:bg-[#2b3737]\">\n                    <MicrophoneIcon className=\"w-5 h-5 text-white\" />\n                  </button>\n                )}\n              </div>\n            </form>\n          </>\n        ) : (\n          <div className={`flex-1 flex items-center justify-center ${WA_BACKGROUND}`}>\n            <div className=\"text-center text-gray-700\">\n              <h2 className=\"text-2xl font-semibold mb-2\">Keep your phone connected</h2>\n              <p className=\"text-sm\">WhatsApp connects to your phone to sync messages. To send and receive messages, keep your phone connected.</p>\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n};\n\n// WhatsApp-like chat bubble component\nconst WAChatBubble = ({ msg, currentUser, getDecryptedPrivateKey }) => {\n  const [decrypted, setDecrypted] = useState('');\n  const [isDecrypting, setIsDecrypting] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    const decrypt = async () => {\n      if (msg.from === currentUser.username && msg.plaintext) {\n        if (mounted) setDecrypted(msg.plaintext);\n        return;\n      }\n      setIsDecrypting(true);\n      try {\n        const privateKeyArmored = await getDecryptedPrivateKey();\n        const dec = await hybridDecryptMessage(msg.encryptedContent, msg.encryptedAESKey, privateKeyArmored);\n        if (mounted) setDecrypted(dec);\n      } catch (err) {\n        if (mounted) setDecrypted('[Encrypted]');\n      } finally {\n        if (mounted) setIsDecrypting(false);\n      }\n    };\n    decrypt();\n    return () => { mounted = false; };\n  }, [msg, currentUser]);\n\n  const isSent = msg.from === currentUser.username;\n  const timeLabel = new Date(msg.timestamp || Date.now()).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n\n  // WhatsApp colours: incoming = white, outgoing = green\n  if (isSent) {\n    return (\n      <div className=\"self-end flex items-end gap-2 max-w-full\">\n        <div className=\"flex flex-col items-end\">\n          <div className=\"rounded-bl-2xl rounded-tl-2xl rounded-tr-xl px-4 py-2\" style={{ background: WA_GREEN, color: 'white' }}>\n            <div className=\"text-sm leading-relaxed\">{isDecrypting ? 'Decrypting...' : decrypted}</div>\n          </div>\n          <div className=\"text-xs text-gray-200 mt-1 flex items-center gap-1 justify-end\">\n            <span>{timeLabel}</span>\n            <CheckIcon className=\"w-4 h-4 text-white opacity-90\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"self-start flex items-start gap-3 max-w-full\">\n      <div className=\"flex-shrink-0\">{/* optional sender avatar could go here */}</div>\n      <div>\n        <div className=\"rounded-br-2xl rounded-tr-2xl rounded-tl-xl px-4 py-2 bg-white text-gray-900\">\n          <div className=\"text-sm leading-relaxed\">{isDecrypting ? 'Decrypting...' : decrypted}</div>\n        </div>\n        <div className=\"text-xs text-gray-400 mt-1\">{timeLabel}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatContainer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}